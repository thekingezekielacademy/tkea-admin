<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç DEEP DIAGNOSTIC - Mini Browser Analysis</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        .section {
            background: rgba(255,255,255,0.2);
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #00ff88;
        }
        .error { border-left-color: #ff4444; }
        .warning { border-left-color: #ffaa00; }
        .success { border-left-color: #00ff88; }
        .info { border-left-color: #4488ff; }
        h1 { text-align: center; margin-bottom: 30px; }
        h2 { margin-top: 0; color: #00ff88; }
        .log { 
            background: rgba(0,0,0,0.3); 
            padding: 10px; 
            border-radius: 5px; 
            font-family: monospace; 
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        .test-button {
            background: #00ff88;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        .test-button:hover { background: #00cc66; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç DEEP DIAGNOSTIC - Mini Browser Analysis</h1>
        
        <div class="section info">
            <h2>üì± Browser Detection</h2>
            <div id="browser-info">Loading...</div>
        </div>

        <div class="section">
            <h2>üåê Network & Loading</h2>
            <div id="network-info">Loading...</div>
        </div>

        <div class="section">
            <h2>üì¶ Script Loading Test</h2>
            <button class="test-button" onclick="testScriptLoading()">Test Main Bundle Loading</button>
            <div id="script-loading-results"></div>
        </div>

        <div class="section">
            <h2>‚öõÔ∏è React Detection Test</h2>
            <button class="test-button" onclick="testReactDetection()">Test React Availability</button>
            <div id="react-detection-results"></div>
        </div>

        <div class="section">
            <h2>üîß Console Logs</h2>
            <div id="console-logs" class="log">Console logs will appear here...</div>
        </div>

        <div class="section">
            <h2>üö® Error Analysis</h2>
            <div id="error-analysis">No errors detected yet...</div>
        </div>
    </div>

    <script>
        // Capture all console logs
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        const logs = [];

        function addLog(type, message) {
            const timestamp = new Date().toLocaleTimeString();
            logs.push(`[${timestamp}] ${type.toUpperCase()}: ${message}`);
            document.getElementById('console-logs').textContent = logs.join('\n');
        }

        console.log = function(...args) {
            addLog('log', args.join(' '));
            originalLog.apply(console, args);
        };

        console.error = function(...args) {
            addLog('error', args.join(' '));
            originalError.apply(console, args);
        };

        console.warn = function(...args) {
            addLog('warn', args.join(' '));
            originalWarn.apply(console, args);
        };

        // Browser detection
        function detectBrowser() {
            const ua = navigator.userAgent;
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua);
            const isInApp = /FBAN|FBAV|FBIOS|Instagram|Line|Twitter|LinkedIn|WhatsApp|Telegram|wv\)/i.test(ua);
            const isSafari = /Safari/i.test(ua) && !/Chrome|CriOS|EdgA|Firefox|FxiOS|OPR|Vivaldi/i.test(ua);
            const isIOS = /iPad|iPhone|iPod/.test(ua);
            const isAndroid = /Android/i.test(ua);
            const isChrome = /Chrome/i.test(ua);
            const isFirefox = /Firefox/i.test(ua);

            return {
                userAgent: ua,
                isMobile,
                isInApp,
                isSafari,
                isIOS,
                isAndroid,
                isChrome,
                isFirefox,
                screenWidth: window.screen.width,
                screenHeight: window.screen.height,
                viewportWidth: window.innerWidth,
                viewportHeight: window.innerHeight,
                devicePixelRatio: window.devicePixelRatio,
                location: window.location.href,
                hash: window.location.hash,
                protocol: window.location.protocol,
                hostname: window.location.hostname
            };
        }

        // Network info
        function getNetworkInfo() {
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            return {
                online: navigator.onLine,
                connectionType: connection ? connection.effectiveType : 'unknown',
                downlink: connection ? connection.downlink : 'unknown',
                rtt: connection ? connection.rtt : 'unknown',
                saveData: connection ? connection.saveData : 'unknown'
            };
        }

        // Test script loading
        function testScriptLoading() {
            const resultsDiv = document.getElementById('script-loading-results');
            resultsDiv.innerHTML = '<div class="log">Testing script loading...</div>';
            
            console.log('üîç Starting script loading test...');
            
            const script = document.createElement('script');
            script.src = '/static/js/main.c7ec5a73.js';
            
            const startTime = Date.now();
            
            script.onload = function() {
                const loadTime = Date.now() - startTime;
                console.log(`‚úÖ Script loaded successfully in ${loadTime}ms`);
                
                // Test if React is available after loading
                setTimeout(() => {
                    const reactAvailable = typeof React !== 'undefined';
                    const reactDOMAvailable = typeof ReactDOM !== 'undefined';
                    const windowReactAvailable = typeof window.React !== 'undefined';
                    const windowReactDOMAvailable = typeof window.ReactDOM !== 'undefined';
                    
                    resultsDiv.innerHTML = `
                        <div class="log">
Script Load Time: ${loadTime}ms
React Available: ${reactAvailable}
ReactDOM Available: ${reactDOMAvailable}
Window.React Available: ${windowReactAvailable}
Window.ReactDOM Available: ${windowReactDOMAvailable}
Script Size: ${script.src}
                        </div>
                    `;
                    
                    console.log('Script loading test completed');
                }, 1000);
            };
            
            script.onerror = function(error) {
                console.error('‚ùå Script failed to load:', error);
                resultsDiv.innerHTML = '<div class="log error">‚ùå Script failed to load</div>';
            };
            
            document.head.appendChild(script);
        }

        // Test React detection
        function testReactDetection() {
            const resultsDiv = document.getElementById('react-detection-results');
            resultsDiv.innerHTML = '<div class="log">Testing React detection...</div>';
            
            console.log('üîç Starting React detection test...');
            
            // Test multiple ways to access React
            const tests = [
                { name: 'React (global)', available: typeof React !== 'undefined', value: typeof React !== 'undefined' ? React : null },
                { name: 'ReactDOM (global)', available: typeof ReactDOM !== 'undefined', value: typeof ReactDOM !== 'undefined' ? ReactDOM : null },
                { name: 'window.React', available: typeof window.React !== 'undefined', value: typeof window.React !== 'undefined' ? window.React : null },
                { name: 'window.ReactDOM', available: typeof window.ReactDOM !== 'undefined', value: typeof window.ReactDOM !== 'undefined' ? window.ReactDOM : null },
                { name: 'window.React.createElement', available: typeof window.React !== 'undefined' && typeof window.React.createElement === 'function', value: null },
                { name: 'window.ReactDOM.createRoot', available: typeof window.ReactDOM !== 'undefined' && typeof window.ReactDOM.createRoot === 'function', value: null }
            ];
            
            let results = 'React Detection Results:\n';
            tests.forEach(test => {
                results += `${test.name}: ${test.available ? '‚úÖ Available' : '‚ùå Not Available'}\n`;
                if (test.available && test.value) {
                    results += `  Type: ${typeof test.value}\n`;
                    results += `  Constructor: ${test.value.constructor ? test.value.constructor.name : 'N/A'}\n`;
                }
            });
            
            resultsDiv.innerHTML = `<div class="log">${results}</div>`;
            console.log('React detection test completed');
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîç Deep diagnostic page loaded');
            
            // Browser info
            const browserInfo = detectBrowser();
            document.getElementById('browser-info').innerHTML = `
                <div class="log">
User Agent: ${browserInfo.userAgent}
Mobile: ${browserInfo.isMobile ? '‚úÖ Yes' : '‚ùå No'}
In-App Browser: ${browserInfo.isInApp ? '‚úÖ Yes' : '‚ùå No'}
Safari: ${browserInfo.isSafari ? '‚úÖ Yes' : '‚ùå No'}
iOS: ${browserInfo.isIOS ? '‚úÖ Yes' : '‚ùå No'}
Android: ${browserInfo.isAndroid ? '‚úÖ Yes' : '‚ùå No'}
Chrome: ${browserInfo.isChrome ? '‚úÖ Yes' : '‚ùå No'}
Firefox: ${browserInfo.isFirefox ? '‚úÖ Yes' : '‚ùå No'}
Screen: ${browserInfo.screenWidth}x${browserInfo.screenHeight}
Viewport: ${browserInfo.viewportWidth}x${browserInfo.viewportHeight}
Pixel Ratio: ${browserInfo.devicePixelRatio}
Location: ${browserInfo.location}
Hash: ${browserInfo.hash || '[empty]'}
Protocol: ${browserInfo.protocol}
Hostname: ${browserInfo.hostname}
                </div>
            `;
            
            // Network info
            const networkInfo = getNetworkInfo();
            document.getElementById('network-info').innerHTML = `
                <div class="log">
Online: ${networkInfo.online ? '‚úÖ Yes' : '‚ùå No'}
Connection Type: ${networkInfo.connectionType}
Downlink: ${networkInfo.downlink} Mbps
RTT: ${networkInfo.rtt} ms
Save Data: ${networkInfo.saveData ? '‚úÖ Yes' : '‚ùå No'}
                </div>
            `;
            
            // Error analysis
            window.addEventListener('error', function(e) {
                console.error('Global error caught:', e.error);
                document.getElementById('error-analysis').innerHTML = `
                    <div class="log error">
Error: ${e.message}
File: ${e.filename}
Line: ${e.lineno}
Column: ${e.colno}
Stack: ${e.error ? e.error.stack : 'No stack trace'}
                    </div>
                `;
            });
            
            // Unhandled promise rejections
            window.addEventListener('unhandledrejection', function(e) {
                console.error('Unhandled promise rejection:', e.reason);
                document.getElementById('error-analysis').innerHTML = `
                    <div class="log error">
Unhandled Promise Rejection: ${e.reason}
                    </div>
                `;
            });
        });
    </script>
</body>
</html>
